USE DWH;
USE SCHEMA DWH_PRE_STAGE;

CREATE OR REPLACE TABLE DWH_PRE_STAGE.BUSINESSNAME_PARTY
(
  ID INTEGER
  ,NAME STRING
  ,ADDRESS STRING
  --,META_REC_SRCE_FILE_NAME STRING
  --,META_REC_SRCE_ROW_NUM INTEGER
);

--Run 0:
DELETE FROM DWH_PRE_STAGE.BUSINESSNAME_PARTY;

--Run 1:

COPY INTO DWH_PRE_STAGE.BUSINESSNAME_PARTY 
FROM (SELECT T.$1,T.$2,T.$3 
        FROM @LANDING_AREA_CSV T);

SELECT * FROM DWH_PRE_STAGE.BUSINESSNAME_PARTY;

--Run 2:
DELETE FROM DWH_PRE_STAGE.BUSINESSNAME_PARTY;

COPY INTO DWH_PRE_STAGE.BUSINESSNAME_PARTY 
FROM (SELECT parse_json($1):ID, parse_json($1):NAME, parse_json($1):ADDRESS
        FROM @LANDING_AREA_JSON T);

SELECT * FROM DWH_PRE_STAGE.BUSINESSNAME_PARTY;
